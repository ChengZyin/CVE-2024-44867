1、 Affected products and versions
  phpok3.0 open source CMS
2、 Vulnerability type
  Arbitrary file read
3、 CVE ID
  CVE-2024-44867
4、 Vulnerability exploitation process
  4.1、 Have permission to access the website backend
  4.2、 By auditing the source code `libs/autoload/file.php`
    ![image](https://github.com/user-attachments/assets/d80758e1-605f-4d47-88e2-8b39f78549a6)
    The PHP built-in function `file_get_contents` is used in the function `cat`
  4.3、 Tracing to `app/admin/control/tpl.php`
    ![image](https://github.com/user-attachments/assets/3782162e-74e4-4853-bcef-a0c0feac2f73)
    The `cat` function under `file.php` is used in the function `tpl_set_f`. At the same time, auditing this section of code, it is found that the parameter `filename` is a controllable variable. Since it is a controllable variable, it indirectly leads to the directory traversal in the `file_exists($dirlist.$tplfile)` code below.
  4.4、 Final exploit
    payload：http://x.x.x.x/admin.php?c=tpl&f=tpl_set&id=1&filename=../../../../../../../../../flag.txt
    ![image](https://github.com/user-attachments/assets/107d4583-2838-4bfc-9bb7-327282f8e97a)


